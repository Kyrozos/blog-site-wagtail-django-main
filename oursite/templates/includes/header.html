{% load i18n wagtailcore_tags wagtailuserbar menu_tags %}
{% get_current_language as LANGUAGE_CODE %}

<header>
    <nav>
        <button class="hamburger" id="hamburger-btn" aria-label="Open menu" aria-expanded="false">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <div class="navbar-menu" id="navbar-menu">
            {% main_menu ul_class="navbar-nav" %}
        </div>
        <form class="navbar-lang" action="{% url 'set_language' %}" method="post" style="display:inline; margin-left:2rem;">
            {% csrf_token %}
            <select name="language" onchange="this.form.submit()">
                {% get_available_languages as LANGUAGES %}
                {% for lang_code, lang_name in LANGUAGES %}
                    <option value="{{ lang_code }}" {% if LANGUAGE_CODE == lang_code %}selected{% endif %}>{{ lang_name }}</option>
                {% endfor %}
            </select>
            <input type="hidden" name="next" value="{{ request.get_full_path }}">
        </form>
    </nav>
</header>